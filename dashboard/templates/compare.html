<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Load Test Dashboard</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gridstack@10.3.0/dist/gridstack.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/2.1.8/css/dataTables.dataTables.min.css">

  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <div style="font-size: 22px; font-weight: 700;">Load Test Dashboard</div>
        <div class="small">Excel input → SQLite history → interactive charts & compare</div>
      </div>
      <div class="nav">
        <a href="/overview">Overview</a>
        <a href="/dashboard">Dashboard</a>
        <a href="/compare" class="active">Compare</a>
      </div>
    </div>
    <hr/>

    <div class="page-head">
      <div>
        <div class="page-title">
          <span class="page-icon">⚖️</span>
          <div>
            <div style="font-weight:800; font-size:18px;">Compare</div>
            <div class="page-sub">Side-by-side runs • Regressions • SLA view</div>
          </div>
        </div>
      </div>
      <div id="runChip" class="chip" style="display:none;"></div>
    </div>

    <div class="card">
      <div class="row" style="align-items:flex-end;">
        <div style="flex: 1 1 520px;">
          <div style="font-weight:700; margin-bottom: 8px;">Select up to 4 runs</div>
          <div id="runsChecklist" class="row"></div>
          <div class="small" style="margin-top: 8px;">
            Tip: pick a baseline as the first checked run.
          </div>
        </div>
        <div style="flex: 1 1 320px;">
          <div class="small">Users load (optional)</div>
          <input id="loadInput" placeholder="e.g. 50" />
          <div class="small" style="margin-top: 8px;">Endpoint (optional exact match)</div>
          <input id="endpointInput" placeholder="/api/search" />
          <div style="margin-top: 12px;">
            <!-- PRIMARY ACTION -->
            <button id="compareBtn" class="primary">Compare</button>
          </div>
        </div>
      </div>
    </div>

    <div class="row" style="margin-top: 12px;">
      <div class="card" id="compareChartCard" style="flex:1 1 520px;">
  <div class="card-head">
    <div style="font-weight:700;">Avg (ms) side-by-side</div>
    <button
      id="maximizeCompareChartBtn"
      class="icon-btn"
      title="Maximize chart"
      aria-label="Maximize chart">⛶</button>
  </div>

  <canvas id="compareChart" height="160"></canvas>
</div>

      <div class="card" style="flex:1 1 520px;" id="compareTableCard">
  <div class="card-head">
    <div style="font-weight:700;">Comparison Table</div>
    <button id="maximizeTableBtn" class="icon-btn" title="Maximize table" aria-label="Maximize table">⛶</button>
  </div>
  <div class="table-wrap">
          <table id="compareTable" class="display" style="width:100%">
            <thead><tr id="compareHeader"></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>

    <script src="{{ url_for('static', filename='js/common.js') }}"></script>
    <script src="{{ url_for('static', filename='js/compare.js') }}"></script>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gridstack@10.3.0/dist/gridstack-all.js"></script>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.datatables.net/2.1.8/js/dataTables.min.js"></script>

  <script>
    function setActiveNav(){
      const path = window.location.pathname || '/';
      document.querySelectorAll('.nav a').forEach(a=>{
        const href = a.getAttribute('href');
        if (href && (path === href || (path === '/' && href === '/overview')))
          a.classList.add('active');
      });
    }
    setActiveNav();
  </script>
</body>
</html>